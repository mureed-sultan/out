(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9093],{42008:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/pages/provider",function(){return s(49373)}])},85177:function(e,a,s){"use strict";s.r(a);var l=s(85893),r=s(67294),n=s(2999),i=s(3902);s(86142),a.default=e=>{let{children:a}=e,[s,t]=(0,r.useState)(!0);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"main-wrapper",children:[(0,l.jsx)(n.default,{}),(0,l.jsx)(i.default,{}),(0,l.jsx)("main",{children:a})]})})}},49373:function(e,a,s){"use strict";s.r(a);var l=s(85893),r=s(67294),n=s(85177),i=s(25675),t=s.n(i),c=s(99811),d=s(93680),o=s(46869);a.default=function(){let[e,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(null),[h,m]=(0,r.useState)({name:"",email:"",phone:"",image:{asset:{_ref:"image-123"}},products:""}),[x,j]=(0,r.useState)(null),[p,u]=(0,r.useState)([]),[v,f]=(0,r.useState)(!1),[N,g]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{let e=await c.Z.fetch('*[_type == "provider"]');a(e);let s=await c.Z.fetch('*[_type == "product"].title');u(s.map(e=>e))}catch(e){console.error("Error fetching data:",e)}})()},[]);let y=async s=>{try{await c.Z.delete(s),a(e.filter(e=>e._id!==s))}catch(e){console.error("Error deleting provider:",e)}},Z=e=>{let{name:a,value:l}=e.target;i({...s,[a]:l})},_=async()=>{try{s?(await c.Z.patch(s._id).set(s).commit(),f(!1),alert("Changes updated")):console.error("No provider selected.")}catch(e){console.error("Error updating provider details:",e)}},C=e=>{i(e),f(!0)},P=e=>{let{name:a,value:s}=e.target;m({...h,[a]:s})},E=async()=>{w(!0);try{if(!h.name||!h.email||!h.phone||!h.products||!x){alert("Please fill in all fields and select an image");return}if((await c.Z.fetch("*[_type == 'provider' && (email == $email || phone == $phone || name == $name)]",{email:h.email,phone:h.phone,name:h.name,password:h.password})).length>0){alert("Provider with this email, phone, or name already exists. Please use different details.");return}let e=await c.Z.assets.upload("image",x,{filename:x.name});await c.Z.create({_type:"provider",...h,image:{asset:{_ref:e._id}}});let s=await c.Z.fetch('*[_type == "provider"]');a(s),g(!1),m({name:"",email:"",phone:"",products:"",password:""}),j(null),alert("Provider Created Successfully"),w(!1)}catch(e){console.error("Error adding new provider:",e),alert("Failed to create provider")}};return(0,l.jsxs)(n.default,{children:[(0,l.jsx)("div",{className:"page-wrapper page-settings",children:(0,l.jsxs)("div",{className:"content",children:[(0,l.jsxs)("div",{className:"content-page-header content-page-headersplit",children:[(0,l.jsx)("h5",{children:"Provider List"}),(0,l.jsx)(d.Z,{variant:"primary",onClick:()=>{g(!0)},children:"Add New"})]}),(0,l.jsx)("div",{className:"row",children:(0,l.jsx)("div",{className:"col-12",children:(0,l.jsxs)("div",{className:"tab-sets",children:[(0,l.jsx)("div",{className:"tab-contents-sets",children:(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",className:"active",children:"All Provider"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",children:"In Work"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",children:"Free"})}),(0,l.jsx)("li",{children:(0,l.jsx)("a",{href:"#",children:"On Leave"})})]})}),(0,l.jsx)("div",{className:"tab-contents-count",children:(0,l.jsxs)("h6",{children:["Showing ",e.length," results"]})})]})})}),(0,l.jsx)("div",{className:"row",children:(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("div",{className:"table-responsive",children:(0,l.jsxs)("table",{className:"table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"#"}),(0,l.jsx)("th",{children:"Image"}),(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Phone"}),(0,l.jsx)("th",{children:"Service Provided"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:e.map((e,a)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:a+1}),(0,l.jsx)("td",{children:e.image?(0,l.jsx)(t(),{src:"https://cdn.sanity.io/images/z5hb38ic/production/".concat(e.image.asset._ref.replace("image-","").replace(/-([^/-]*)$/,".$1")),width:100,height:100,className:"",alt:"Demo section"}):(0,l.jsx)(l.Fragment,{children:"Image not Found"})}),(0,l.jsx)("td",{children:e.name}),(0,l.jsx)("td",{children:e.email}),(0,l.jsx)("td",{children:e.phone}),(0,l.jsx)("td",{children:e.products&&e.products.map((e,a)=>(0,l.jsxs)("span",{children:[e,(0,l.jsx)("br",{})]},a))}),(0,l.jsxs)("td",{children:[(0,l.jsx)(d.Z,{variant:"primary",onClick:()=>C(e),children:"Edit"})," ",(0,l.jsx)(d.Z,{variant:"danger",onClick:()=>y(e._id),children:"Delete"})]})]},e._id))})]})})})})]})}),(0,l.jsxs)(o.Z,{show:v,onHide:()=>f(!1),children:[(0,l.jsx)(o.Z.Header,{closeButton:!0,children:(0,l.jsx)(o.Z.Title,{children:"Edit Provider"})}),(0,l.jsx)(o.Z.Body,{children:s&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"name",value:s.name,onChange:Z})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Email"}),(0,l.jsx)("input",{type:"email",className:"form-control",name:"email",value:s.email,onChange:Z})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Phone"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"phone",value:s.phone,onChange:Z})]})]})}),(0,l.jsxs)(o.Z.Footer,{children:[(0,l.jsx)(d.Z,{variant:"secondary",onClick:()=>f(!1),children:"Close"}),(0,l.jsx)(d.Z,{variant:"primary",onClick:_,children:"Save Changes"})]})]}),(0,l.jsxs)(o.Z,{show:N,onHide:()=>g(!1),children:[(0,l.jsx)(o.Z.Header,{closeButton:!0,children:(0,l.jsx)(o.Z.Title,{children:"Add New Provider"})}),(0,l.jsx)(o.Z.Body,{children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"name",value:h.name,onChange:P})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Email"}),(0,l.jsx)("input",{type:"email",className:"form-control",name:"email",value:h.email,onChange:P})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Phone"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"phone",value:h.phone,onChange:P})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Service Provided"}),(0,l.jsx)("select",{className:"form-select",name:"products",multiple:!0,value:h.products,onChange:e=>{let{options:a}=e.target,s=[];for(let e=0;e<a.length;e++)a[e].selected&&s.push(a[e].value);m({...h,products:s})},children:p.map((e,a)=>(0,l.jsx)("option",{value:e,children:e},a))})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"Image"}),(0,l.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{let a=e.target.files&&e.target.files[0];a&&j(a)}})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"form-label",children:"password"}),(0,l.jsx)("input",{type:"text",className:"form-control",name:"password",value:h.password,onChange:P})]})]})}),(0,l.jsxs)(o.Z.Footer,{children:[(0,l.jsx)(d.Z,{variant:"secondary",onClick:()=>g(!1),children:"Close"}),(0,l.jsx)(d.Z,{variant:"primary",onClick:E,children:b?"Processing":"Save New Provider"})]})]})]})}},86142:function(){}},function(e){e.O(0,[571,8764,5675,9668,4440,1664,4620,2010,3902,2999,7034,2888,9774,179],function(){return e(e.s=42008)}),_N_E=e.O()}]);