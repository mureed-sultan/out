(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6916],{86986:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/pages/servicesOrder",function(){return s(54802)}])},85177:function(e,r,s){"use strict";s.r(r);var t=s(85893),l=s(67294),a=s(2999),i=s(3902);s(86142),r.default=e=>{let{children:r}=e,[s,c]=(0,l.useState)(!0);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"main-wrapper",children:[(0,t.jsx)(a.default,{}),(0,t.jsx)(i.default,{}),(0,t.jsx)("main",{children:r})]})})}},54802:function(e,r,s){"use strict";s.r(r);var t=s(85893),l=s(67294),a=s(25675),i=s.n(a),c=s(85177),n=s(99811);r.default=function(){let[e,r]=(0,l.useState)([]),[s,a]=(0,l.useState)(null),[d,o]=(0,l.useState)(!1),[h,m]=(0,l.useState)([]),[x,j]=(0,l.useState)(""),[u,g]=(0,l.useState)(!1),[p,v]=(0,l.useState)(1),[N,f]=(0,l.useState)(""),[b,_]=(0,l.useState)(""),[y,w]=(0,l.useState)([{value:"pending",title:"pending"},{value:"inprogress",title:"In Progress"},{value:"complete",title:"Complete"}]);(0,l.useEffect)(()=>{let e=async()=>{try{let e=(p-1)*10,s='*[_type == "order"';b&&(s+=' && status == "'.concat(b,'"')),s+="] | order(_createdAt desc)[".concat(e,"...").concat(e+10-1,']{ ..., "imageUrl1":image1.asset->url, "imageUrl2":image2.asset->url, "imageUrl3":image3.asset->url, "imageUrl4":image4.asset->url, "imageUrl5":image5.asset->url, }');let t=await n.Z.fetch(s),l=[];for(let e of t){let r=await n.Z.fetch('*[_type == "product" && title == "'.concat(e.titleOfWork,'"]'));if(r&&r.length>0){let s=r[0].categories._ref,t=await n.Z.fetch('*[_type == "category" && _id == "'.concat(s,'"]'));t[0].title,r[0].images;let a=e.username,i=await n.Z.fetch('*[_type == "user" && username == "'.concat(a,'"]'));i.length>0?(i[0].username,i[0].profilepicture):e.username;let c={order:e,product:{...r[0],status:e.status},category:t[0],user:i[0]};l.push(c)}}r(l),g(!0)}catch(e){console.error("Error fetching orders:",e)}};(async()=>{try{let e=(await n.Z.fetch('*[_type == "provider"]')).map(e=>e.name);m(e)}catch(e){console.error("Error fetching providers:",e)}})(),e()},[b]);let k=async e=>{try{await n.Z.delete(e),r(r=>r.filter(r=>r.order._id!==e))}catch(e){console.error("Error deleting order:",e)}},S=async r=>{let s=e.find(e=>e.order._id===r);s&&(a(s),o(!0),j((.75*parseFloat(s.order.costproduct)).toFixed(2)))},C=async()=>{try{if(s){let{order:e}=s,t={_id:e._id,status:e.status},l=await n.Z.fetch('*[_type == "provider" && name == "'.concat(e.provider,'"]'));if(l&&l.length>0){let e=l[0].name;t.provider=e}await n.Z.patch(e._id).set(t).commit();let a=l[0]._id,i=.8*parseFloat(e.costproduct),c=Date.now().toString(),d={_id:a,payment:[...l[0].payment,{_key:c,title:e.titleOfWork,price:i,adminInstruction:N}]};await n.Z.patch(a).set(d).commit(),r(r=>r.map(r=>r.order._id===e._id?{...r,order:{...r.order,...t}}:r))}}catch(e){console.error("Error updating order:",e)}a(null),o(!1)},U=e=>{v(e)};return(0,t.jsxs)(c.default,{children:[(0,t.jsx)("div",{className:"page-wrapper page-settings",children:(0,t.jsxs)("div",{className:"content",children:[(0,t.jsxs)("div",{className:"content-page-header content-page-headersplit",children:[(0,t.jsx)("h5",{children:"All Services"}),(0,t.jsx)("div",{className:"list-btn",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("div",{className:"filter-sorting",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsxs)("a",{className:"filter-sets",children:[(0,t.jsx)("i",{className:"fe fe-filter me-2"}),"Filter"]})}),(0,t.jsxs)("li",{children:[(0,t.jsx)("span",{children:(0,t.jsx)(i(),{width:50,height:50,src:"/admin/img/icons/sort.svg",className:"me-2",alt:"img"})}),(0,t.jsx)("div",{className:"review-sort",children:(0,t.jsxs)("select",{className:"select",children:[(0,t.jsxs)("option",{children:["A -",">"," Z"]}),(0,t.jsxs)("option",{children:["Z -",">"," A"]})]})})]})]})})}),(0,t.jsx)("li",{children:(0,t.jsxs)("a",{className:"btn btn-primary",href:"add-service.html",children:[(0,t.jsx)("i",{className:"fa fa-plus me-2"}),"Create Service"]})})]})})]}),(0,t.jsx)("div",{className:"row",children:(0,t.jsx)("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"tab-sets",children:[(0,t.jsx)("div",{className:"tab-contents-sets",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{className:""==b?"active cursor-pointer":"cursor-pointer",onClick:()=>{_("")},children:"All Services"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{className:"inprogress"==b?"active cursor-pointer":"cursor-pointer",onClick:()=>{_("inprogress")},children:"Active"})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{className:"Pending"==b?"active cursor-pointer":"cursor-pointer",onClick:()=>{_("Pending")},children:"Pending "})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{className:"complete"==b?"active cursor-pointer":"cursor-pointer",onClick:()=>{_("complete")},children:"Completed "})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{children:"Deleted "})})]})}),(0,t.jsx)("div",{className:"tab-contents-count",children:(0,t.jsxs)("h6",{children:["Showing ",e.length," results"]})})]})})}),(0,t.jsx)("div",{className:"row",children:(0,t.jsxs)("div",{className:"col-12",children:[(0,t.jsx)("div",{className:"table-resposnive table-div",children:(0,t.jsxs)("table",{className:"table datatable",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"#"}),(0,t.jsx)("th",{children:"Service"}),(0,t.jsx)("th",{children:"Category"}),(0,t.jsx)("th",{children:"Status"}),(0,t.jsx)("th",{children:"Price"}),(0,t.jsx)("th",{children:"Origional Price"}),(0,t.jsx)("th",{children:"Order date"}),(0,t.jsx)("th",{children:"Order time"}),(0,t.jsx)("th",{children:"Instruction"}),(0,t.jsx)("th",{children:"Created At"}),(0,t.jsx)("th",{children:"Image1"}),(0,t.jsx)("th",{children:"Image2"}),(0,t.jsx)("th",{children:"Image3"}),(0,t.jsx)("th",{children:"Image4"}),(0,t.jsx)("th",{children:"Image5"}),(0,t.jsx)("th",{children:"Customer"}),(0,t.jsx)("th",{children:"Provider"}),(0,t.jsx)("th",{children:"Action"})]})}),(0,t.jsx)("tbody",{children:u?e.map((e,r)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:r+1}),(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:"table-imgname",children:(0,t.jsxs)("span",{className:"d-flex align-items-center",children:[(0,t.jsx)(i(),{width:50,height:50,src:"/admin/img/services/service-03.jpg",className:"me-2",alt:"img"}),(0,t.jsx)("span",{children:e.product.title})]})})}),(0,t.jsx)("td",{children:e.category.title}),(0,t.jsx)("td",{children:e.order.status?e.order.status:(0,t.jsx)("p",{children:"Pending"})}),(0,t.jsxs)("td",{children:["AED ",e.order.costproduct?e.order.costproduct:"0"]}),(0,t.jsxs)("td",{children:["AED ",e.order.origionalPrice?e.order.origionalPrice:"0"]}),(0,t.jsx)("td",{children:e.order.workingDate}),(0,t.jsx)("td",{children:e.order.hoursNeeded}),(0,t.jsx)("td",{children:e.order.instruction?e.order.instruction:""}),(0,t.jsx)("td",{children:e.order._createdAt?e.order._createdAt:""}),(0,t.jsx)("td",{children:e.order.imageUrl1?(0,t.jsx)("a",{href:e.order.imageUrl1,target:"_blank",children:(0,t.jsx)(i(),{width:100,height:100,src:e.order.imageUrl1,alt:""})}):(0,t.jsx)(t.Fragment,{children:"No Image"})}),(0,t.jsx)("td",{children:e.order.imageUrl2?(0,t.jsx)("a",{href:e.order.imageUrl2,target:"_blank",children:(0,t.jsx)(i(),{width:100,height:100,src:e.order.imageUrl2,alt:""})}):(0,t.jsx)(t.Fragment,{children:"No Image"})}),(0,t.jsx)("td",{children:e.order.imageUrl3?(0,t.jsx)("a",{href:e.order.imageUrl3,target:"_blank",children:(0,t.jsx)(i(),{width:100,height:100,src:e.order.imageUrl3,alt:""})}):(0,t.jsx)(t.Fragment,{children:"No Image"})}),(0,t.jsx)("td",{children:e.order.imageUrl4?(0,t.jsx)("a",{href:e.order.imageUrl4,target:"_blank",children:(0,t.jsx)(i(),{width:100,height:100,src:e.order.imageUrl4,alt:""})}):(0,t.jsx)(t.Fragment,{children:"No Image"})}),(0,t.jsx)("td",{children:e.order.imageUrl5?(0,t.jsx)("a",{href:e.order.imageUrl5,target:"_blank",children:(0,t.jsx)(i(),{width:100,height:100,src:e.order.imageUrl5,alt:""})}):(0,t.jsx)(t.Fragment,{children:"No Image"})}),(0,t.jsx)("td",{children:(0,t.jsx)("a",{href:"#",className:"table-profileimage",children:(0,t.jsx)("span",{children:e.user?e.user.username:e.order.username+" (Guest)"})})}),(0,t.jsx)("td",{children:e.order.provider?e.order.provider:(0,t.jsx)("p",{children:"No Selected"})}),(0,t.jsx)("td",{children:(0,t.jsxs)("div",{className:"action-language",children:[(0,t.jsxs)("button",{className:"table-edit",onClick:()=>S(e.order._id),children:[(0,t.jsx)("i",{className:"fa-solid fa-edit"}),(0,t.jsx)("span",{children:"Edit"})]}),(0,t.jsxs)("button",{className:"table-delete",onClick:()=>k(e.order._id),children:[(0,t.jsx)("i",{className:"fa-solid fa-trash-can"}),(0,t.jsx)("span",{children:"Delete"})]})]})})]},r)):(0,t.jsx)(t.Fragment,{children:"Loading"})})]})}),(0,t.jsx)("div",{className:"row",children:(0,t.jsx)("div",{className:"col-sm-12",children:(0,t.jsx)("div",{className:"blog-pagination rev-page",children:(0,t.jsx)("nav",{children:(0,t.jsxs)("ul",{className:"pagination justify-content-center",children:[(0,t.jsx)("li",{className:"page-item active",children:(0,t.jsx)("a",{className:"page-link",onClick:()=>{U(1)},children:"1"})}),(0,t.jsx)("li",{className:"page-item",children:(0,t.jsx)("a",{className:"page-link",onClick:()=>{U(2)},children:"2"})}),(0,t.jsx)("li",{className:"page-item",children:(0,t.jsx)("a",{className:"page-link",onClick:()=>{U(3)},children:"3"})})]})})})})})]})})]})}),s&&d&&(0,t.jsx)("div",{className:"modal show",tabIndex:-1,role:"dialog",style:{display:"block"},children:(0,t.jsx)("div",{className:"modal-dialog",role:"document",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h5",{className:"modal-title",children:"Edit Order"}),(0,t.jsx)("button",{type:"button",className:"btn-close text-black","aria-label":"Close",onClick:()=>{a(null),o(!1)},children:"X"})]}),(0,t.jsxs)("div",{className:"modal-body",children:[(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("label",{htmlFor:"providerSelect",className:"form-label",children:"Provider"}),(0,t.jsxs)("select",{className:"form-select",id:"providerSelect",value:null==s?void 0:s.order.provider,onChange:e=>a(r=>({...r,order:{...r.order,provider:e.target.value}})),children:[(0,t.jsx)("option",{value:"",children:"Select a provider"}),h.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("label",{htmlFor:"statusSelect",className:"form-label",children:"Status"}),(0,t.jsxs)("select",{className:"form-select",id:"statusSelect",value:null==s?void 0:s.order.status,onChange:e=>{let r=e.target.value;a(e=>({...e,order:{...e.order,status:r}}))},children:[(0,t.jsx)("option",{value:"",children:"Select a status"}),y.map((e,r)=>(0,t.jsx)("option",{value:e.value,children:e.title},r))]}),(0,t.jsxs)("label",{htmlFor:"providerAmount",children:["Enter Amount",(0,t.jsx)("input",{className:"form-select",type:"number",name:"providerAmount",id:"",value:x,onChange:e=>{j(e.target.value)}})]}),(0,t.jsxs)("label",{htmlFor:"providerAmount",children:["Enter instruction to Provider",(0,t.jsx)("input",{className:"form-select",type:"text",name:"providerAmount",id:"",value:N,onChange:e=>{f(e.target.value)}})]})]})]}),(0,t.jsx)("div",{className:"modal-footer",children:(0,t.jsx)("button",{type:"button",className:"btn btn-primary",onClick:C,children:"Save"})})]})})})]})}},86142:function(){}},function(e){e.O(0,[571,8764,5675,9668,4440,1664,2010,3902,2999,7034,2888,9774,179],function(){return e(e.s=86986)}),_N_E=e.O()}]);